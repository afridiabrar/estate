<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Settings</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/framework.css">
    <link rel="stylesheet" type="text/css" href="css/washington.css">
    <link rel="stylesheet" type="text/css" href="css/bootstrap/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="css/my-code.css">
    <link rel="shortcut icon" type="image/x-icon" href="images/circle-icon.png">
    <script src="js/webfont.js"></script>
    <script>
        WebFont.load({
            google: {
                families: ["Montserrat:400,700"]
            }
        });
    </script>
    <script>
        (function (i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r;
            i[r] = i[r] || function () {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date();
            a = s.createElement(o),
                    m = s.getElementsByTagName(o)[0];
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m)
        })(window, document, 'script', 'www.google-analytics.com/analytics.js', 'ga');
        ga('create', 'UA-65113119-1', 'auto');
        ga('send', 'pageview');
    </script>

    <script type="text/javascript" src="js/modernizr.js"></script>
    <link href="css/ionicons.min.css" rel="stylesheet" type="text/css"/>
</head>
<body class="login2">
<section class="w-section mobile-wrapper page3">
    <div class="page-content" id="main-stack">
        <div class="w-nav navbar" data-collapse="all" data-animation="over-left" data-duration="400" data-contain="1"
             data-easing="ease-out-quint" data-no-scroll="1">
            <div class="w-container">
                <nav class="w-nav-menu nav-menu" role="navigation">
                    <div class="nav-menu-header">
                        <div class="col-md-12">
                            <img src="images/logo.png" alt="" class="img-responsive">
                        </div>
                    </div>
                    <a class="w-clearfix w-inline-block nav-menu-link" href="contact.html" data-load="1">
                        <div class="icon-list-menu">
                            <div class="icon ion-ios-contact"></div>
                        </div>
                        <div class="nav-menu-titles">Contact</div>
                    </a>
                    <a class="w-clearfix w-inline-block nav-menu-link" href="calender.html" data-load="1">
                        <div class="icon-list-menu">
                            <div class="icon ion-calendar"></div>
                        </div>
                        <div class="nav-menu-titles">Calender</div>
                    </a>
                    <a class="w-clearfix w-inline-block nav-menu-link" href="settings.html" data-load="1">
                        <div class="icon-list-menu">
                            <div class="icon ion-ios-gear-outline"></div>
                        </div>
                        <div class="nav-menu-titles">Profile Settings</div>
                    </a>
                    <a class="w-clearfix w-inline-block nav-menu-link" href="folder.html" data-load="1">
                        <div class="icon-list-menu">
                            <div class="icon ion-ios-folder"></div>
                        </div>
                        <div class="nav-menu-titles">Folder</div>
                    </a>
                    <a class="w-clearfix w-inline-block nav-menu-link" href="password.html" data-load="1">
                        <div class="icon-list-menu">
                            <div class="icon ion-ios-locked"></div>
                        </div>
                        <div class="nav-menu-titles">Change Password</div>
                    </a>

                    <a class="w-clearfix w-inline-block nav-menu-link last" href="terms.html" data-load="1">
                        <div class="icon-list-menu">
                            <div class="icon ion-ios-bookmarks-outline"></div>
                        </div>
                        <div class="nav-menu-titles">Terms and Conditions</div>
                    </a>
                    <a class="w-clearfix w-inline-block" onclick="logout()" data-load="1">
                        <div class="icon-list-menu">
                            <div class="icon ion-ios-locked-outline"></div>
                        </div>
                        <div class="nav-menu-titles">Logout</div>
                    </a>
                    <div class="separator-bottom"></div>
                    <div class="separator-bottom"></div>
                    <div class="separator-bottom"></div>
                </nav>
                <div class="wrapper-mask" data-ix="menu-mask"></div>
                <div class="navbar-title">Change Password</div>
                <div class="w-nav-button navbar-button left" id="menu-button" data-ix="hide-navbar-icons">
                    <div class="navbar-button-icon home-icon">
                        <div class="bar-home-icon"></div>
                        <div class="bar-home-icon"></div>
                        <div class="bar-home-icon"></div>
                    </div>
                </div>
            </div>
        </div>
        <div class="body">
            <div class="col-xs-12">
                <!--<div class="text-centered"><h3>Apex Miami Reality</h3></div>-->
                <div class="col-xs-4 col-xs-offset-4">
                    <div class="image2">
                        <img src="images/circle-icon.png" alt="" class="img-responsive">
                    </div>
                </div>
            </div>
            <div class="col-xs-12">
                <div class="bottom-section">
                    <div class="w-form">
                        <form id="email-form" name="email-form" data-name="Email Form" action="#">
                            <div>
                                <label class="label-form">Password</label>
                                <input class="w-input input-form" type="password" name="password" >
                                <div class="separator-fields"></div>
                            </div>
                            <div>
                                <label class="label-form">New Password</label>
                                <input class="w-input input-form" type="password" name="password1" >
                                <div class="separator-fields"></div>
                            </div>
                            <div>
                                <label class="label-form">Confirm Password</label>
                                <input class="w-input input-form"  type="password" name="password2">
                                <div class="separator-fields"></div>
                            </div>
                            <input class="w-button action-button" type="button" onclick="update()" value="Update" data-wait="Please wait...">
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="page-content loading-mask" id="new-stack">
        <div class="loading-icon">
            <div class="navbar-button-icon icon ion-load-d"></div>
        </div>
    </div>
    <div class="shadow-layer"></div>
</section>
<script type="text/javascript" src="js/jquery.min.js"></script>
<script type="text/javascript" src="js/framework.js"></script>
<script src="//cdn.jsdelivr.net/npm/alertifyjs@1.11.1/build/alertify.min.js"></script>
<!-- CSS -->
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.11.1/build/css/alertify.min.css"/>
<!-- Default theme -->
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.11.1/build/css/themes/default.min.css"/>
<!-- Semantic UI theme -->
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.11.1/build/css/themes/semantic.min.css"/>
<!-- Bootstrap theme -->
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.11.1/build/css/themes/bootstrap.min.css"/>

<script>
    $(document).ready(function(){
        var data = window.localStorage.getItem("user");
        console.log(data);
        if(data != null){
            if(data['message'] == 'Error'){
                window.location.href = "login.html";
            }
            else{
                var jsondata = JSON.parse(data);
                $("[name=fname]").val(jsondata[0]['fname']);
                $("[name=lname]").val(jsondata[0]['lname']);
                $("[name=email]").val(jsondata[0]['email']);
            }
        }
        else{
            window.location.href = "login.html";
        }

    });
    function update(){
//        var link = "http://localhost/estate/";
        var link = "http://devlabx.com/estate/index.php/api/";
        var data = window.localStorage.getItem("user");
        var jsondata = JSON.parse(data);
        var id = jsondata[0]['id'];
        var password = $("[name=password]").val();
        var password1 = $("[name=password1]").val();
        var password2 = $("[name=password2]").val();
        $.post(link+"/changePassword",{id:id,password:password,password1:password1,password2:password2},function(e){
            console.log(e);
            var json = JSON.parse(e);
            if(json['message'] == 'Change'){
                alertify.success('Password Change');
            }else if(json['message'] == 'Mismatch'){
                alertify.error('Password MisMatch ');
            }else{
                alertify.error('Incorrect Password');
            }
        });
    }

    function logout(){
        window.localStorage.removeItem("user");
        window.location.reload();
    }
</script>
</body>
</html>